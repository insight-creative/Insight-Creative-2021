{{ define "main" }}
<div class="work-hero">
    {{ $image := (.Resources.GetMatch (index .Params.seo.featured_image)) }}

    {{ $webp_src_set := ""}}
    {{ $jpg_src_set := ""}}

    {{ $jpg_xxl := $image.Resize "2500x q90" }}
    {{ $jpg_xl := $jpg_xxl.Resize "1800x q90" }}
    {{ $jpg_l := $jpg_xl.Resize "1200x q90" }}
    {{ $jpg_m := $jpg_l.Resize "800x q90" }}
    {{ $jpg_s := $jpg_l.Resize "600x q90" }}
    {{ $jpg_xs := $jpg_l.Resize "400x q90" }}
    {{ $jpg_src_set = (print $jpg_xs.RelPermalink " 400w" ", " $jpg_s.RelPermalink " 600w" ", "  $jpg_m.RelPermalink " 800w" ", "  $jpg_l.RelPermalink " 1200w" ", "  $jpg_xl.RelPermalink " 1800w" ", "  $jpg_xxl.RelPermalink " 2500w" ) }}

    {{ $webp_xxl := $image.Resize "2500x q90 webp" }}
    {{ $webp_xl := $image.Resize "1800x q90 webp" }}
    {{ $webp_l := $image.Resize "1200x q90 webp" }}
    {{ $webp_m := $webp_l.Resize "800x q90 webp" }}
    {{ $webp_s := $webp_l.Resize "600x q90 webp" }}
    {{ $webp_xs := $webp_l.Resize "400x q90 webp" }}

    {{ $webp_src_set = (print $webp_xs.RelPermalink " 400w" ", " $webp_s.RelPermalink " 600w" ", "  $webp_m.RelPermalink " 800w" ", "  $webp_l.RelPermalink " 1200w" ", "  $webp_xl.RelPermalink " 1800w" ", "  $webp_xxl.RelPermalink " 2500w") }}
  
    <div class="work-hero__image-wrapper hero-parallax">
        <picture>
            <source sizes="100vw" srcset="{{ $webp_src_set }}" type="image/webp" >
            <source sizes="100vw" srcset="{{ $jpg_src_set }}" type="image/jpg" >
            <img sizes="100vw" loading="lazy"
                src="{{ $image.RelPermalink }}" width="{{ $image.Width }}" height="{{ $image.Height }}" alt="{{ .Params.seo.featured_image_alt }}" class="work-hero__image">
        </picture>
    </div>
    <div class="work-hero__header bg-black-2 wrapper-md block">
        <div class="title-reveal">
            <h1 class="title-reveal__title text-center no-margin">{{ .Title }}</h1>
        </div>
    </div>
</div>
<div class="bg-black block">
    <div class="work-specs wrapper-md auto-grid-md">
        <div>
            <h3 class="h4 no-margin">Client</h3>
            <p>{{ .Params.client }}</p>
        </div>
        <div>
            {{ with .Params.provided_services }}
            <div>
            <h3 class="h4 no-margin">What we did</h3>
            <ul>
                {{ range .services }}
                <li><a href="{{ .url }}">{{ .service }}</a></li>
                {{ end }}
            </ul>
            <a href="/services/" class="btn-arrow">View all services {{ partialCached "svg-icons/arrow-circle-right.svg" . }}</a>
            </div>
            {{ end }}
        </div>
        <div>
            <h3 class="h4 no-margin">Project type</h3>
            {{ if .Params.tags }}
            {{ range $index, $elements := .Params.tags }}<a href="{{ `tags/` | relLangURL }}{{ . | urlize | lower }}">{{ if ne $index 0 }}{{ end }}
                {{ . | title }}</a> {{ end}}
            {{ end }}
        </div>
        <div>
            {{ with .Params.industries }}
            <h3 class="h4 no-margin">Industry</h3>
            <ul>
                {{ range .industries }}
                <li>{{ .industry }}</li>
                {{ end }}
            </ul>
            {{ end }}
        </div>
    </div>
</div>
<div class="work-body">
    <div class="block wrapper flow">
        {{ .Params.intro | markdownify }}
    </div>
    <div class="padding-bottom-9">
        {{ .Content }}
    </div>
</div>
{{ if .Params.testimonial }}
<div class="wrapper-md padding-bottom-9">
    <div class="testimonial block bg-black">
        <div class="wrapper-sm flow fade-up">
            <div class="quote">
                {{ partial "svg-icons/quote.svg" . }}
            </div>
            {{ with .Params.testimonial }}
            <p>{{ .copy }}</p>
            <div>
                <h3 class="h5 no-margin">{{ .author }}</h3>
                <h4 class="h6 no-margin">{{ .client }}</h4>
            </div>
            {{ end }}
        </div>
    </div>
</div>
{{ end }}
<div class="wrapper-lg">
    {{ partial "work/project-navigation" . }}
</div>
{{ $related := .Site.RegularPages.RelatedIndices . "tags" | first 3 }}
{{ with $related }}
<div class="wrapper-lg related-projects fade-up padding-top-9">
    <h3>Related Projects</h3>
    <div class="post-wrapper padding-top-2">
        {{ range . }}
        {{ .Render "work-card" }}
        {{ end }}
    </div>
</div>
{{ end }}
{{ partialCached "cta" . }}
{{ end }}